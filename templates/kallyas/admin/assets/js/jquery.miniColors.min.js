;/*
 * jQuery MiniColors: A tiny color picker built on jQuery
 *
 * Copyright Cory LaViska for A Beautiful Site, LLC. (http://www.abeautifulsite.net/)
 *
 * Dual-licensed under the MIT and GPL Version 2 licenses
 *
*/if(jQuery)(function(e){function t(t){var n=e('<span class="minicolors" />'),r=t.attr("data-slider")||e.minicolors.settings.defaultSlider;if(t.data("initialized"))return;n.attr("class",t.attr("data-class")).attr("style",t.attr("data-style")).toggleClass("minicolors-swatch-left",t.attr("data-swatch-position")==="left").toggleClass("minicolors-with-opacity",t.attr("data-opacity")!==undefined);if(t.attr("data-position")!==undefined){e.each(t.attr("data-position").split(" "),function(){n.addClass("minicolors-position-"+this)})}t.data("initialized",true).attr("data-default",t.attr("data-default")||"").attr("data-slider",r).prop("size",35).prop("maxlength",35).wrap(n).after('<span class="minicolors-panel minicolors-slider-'+r+'">'+'<span class="minicolors-slider">'+'<span class="minicolors-picker"></span>'+"</span>"+'<span class="minicolors-opacity-slider">'+'<span class="minicolors-picker"></span>'+"</span>"+'<span class="minicolors-grid">'+'<span class="minicolors-grid-inner"></span>'+'<span class="minicolors-picker"><span></span></span>'+"</span>"+"</span>");t.parent().find(".minicolors-panel").on("selectstart",function(){return false}).end();if(t.attr("data-swatch-position")==="left"){t.before('<span class="minicolors-swatch"><span></span></span>')}else{t.after('<span class="minicolors-swatch"><span></span></span>')}if(t.attr("data-textfield")==="false")t.addClass("minicolors-hidden");if(t.attr("data-control")==="inline")t.parent().addClass("minicolors-inline");a(t)}function n(e){a(e)}function r(e){var t=e.parent();if(e.data("initialized")&&t.hasClass("minicolors")){t.remove()}}function i(t){var n=t.parent(),r=n.find(".minicolors-panel");if(!t.data("initialized")||t.prop("disabled")||n.hasClass("minicolors-focus"))return;s();n.addClass("minicolors-focus");r.stop(true,true).fadeIn(e.minicolors.settings.showSpeed)}function s(){e(".minicolors:not(.minicolors-inline)").each(function(){var t=e(this),n=t.find("INPUT");t.find(".minicolors-panel").fadeOut(e.minicolors.settings.hideSpeed,function(){t.removeClass("minicolors-focus")})})}function o(t,n,r){var i=t.parents(".minicolors").find("INPUT"),s=t.find("[class$=-picker]"),o=t.offset().left,a=t.offset().top,f=Math.round(n.pageX-o),l=Math.round(n.pageY-a),c=r?e.minicolors.settings.animationSpeed:0,h,p,d,v;if(n.originalEvent.changedTouches){f=n.originalEvent.changedTouches[0].pageX-o;l=n.originalEvent.changedTouches[0].pageY-a}if(f<0)f=0;if(l<0)l=0;if(f>t.width())f=t.width();if(l>t.height())l=t.height();if(t.parent().is(".minicolors-slider-wheel")&&s.parent().is(".minicolors-grid")){h=75-f;p=75-l;d=Math.sqrt(h*h+p*p);v=Math.atan2(p,h);if(v<0)v+=Math.PI*2;if(d>75){d=75;f=75-75*Math.cos(v);l=75-75*Math.sin(v)}f=Math.round(f);l=Math.round(l)}if(t.is(".minicolors-grid")){s.stop(true).animate({top:l+"px",left:f+"px"},c,e.minicolors.settings.animationEasing,function(){u(i)})}else{s.stop(true).animate({top:l+"px"},c,e.minicolors.settings.animationEasing,function(){u(i)})}}function u(e){function t(e,t){var n,r;if(!e.length||!t)return null;n=e.offset().left;r=e.offset().top;return{x:n-t.offset().left+e.outerWidth()/2,y:r-t.offset().top+e.outerHeight()/2}}var n,r,i,s,o,u,a,f,l,h,p=e.parent(),v=p.find(".minicolors-panel"),m=p.find(".minicolors-swatch"),g=e.attr("data-opacity")!==undefined,y=e.attr("data-slider"),b=p.find(".minicolors-grid"),w=p.find(".minicolors-slider"),E=p.find(".minicolors-opacity-slider"),S=b.find("[class$=-picker]"),x=w.find("[class$=-picker]"),T=E.find("[class$=-picker]"),N=t(S,b),C=t(x,w),k=t(T,E);switch(y){case"wheel":a=b.width()/2-N.x;f=b.height()/2-N.y;l=Math.sqrt(a*a+f*f);h=Math.atan2(f,a);if(h<0)h+=Math.PI*2;if(l>75){l=75;N.x=69-75*Math.cos(h);N.y=69-75*Math.sin(h)}r=c(l/.75,0,100);n=c(h*180/Math.PI,0,360);i=c(100-Math.floor(C.y*(100/w.height())),0,100);u=d({h:n,s:r,b:i});w.css("backgroundColor",d({h:n,s:r,b:100}));break;case"saturation":n=c(parseInt(N.x*(360/b.width())),0,360);r=c(100-Math.floor(C.y*(100/w.height())),0,100);i=c(100-Math.floor(N.y*(100/b.height())),0,100);u=d({h:n,s:r,b:i});w.css("backgroundColor",d({h:n,s:100,b:i}));p.find(".minicolors-grid-inner").css("opacity",r/100);break;case"brightness":n=c(parseInt(N.x*(360/b.width())),0,360);r=c(100-Math.floor(N.y*(100/b.height())),0,100);i=c(100-Math.floor(C.y*(100/w.height())),0,100);u=d({h:n,s:r,b:i});w.css("backgroundColor",d({h:n,s:r,b:100}));p.find(".minicolors-grid-inner").css("opacity",1-i/100);break;default:n=c(360-parseInt(C.y*(360/w.height())),0,360);r=c(Math.floor(N.x*(100/b.width())),0,100);i=c(100-Math.floor(N.y*(100/b.height())),0,100);u=d({h:n,s:r,b:i});b.css("backgroundColor",d({h:n,s:100,b:100}));break}if(g){s=parseFloat(1-k.y/E.height()).toFixed(2)}else{s=1}e.val(u);if(g)e.attr("data-opacity",s);m.find("SPAN").css({backgroundColor:u,opacity:s});if(u+s!==e.data("last-change")){e.data("last-change",u+s).trigger("change",e)}}function a(e,t){var n,r,i,s,o,u,a,h=e.parent(),p=h.find(".minicolors-swatch"),m=e.attr("data-opacity")!==undefined,g=e.attr("data-slider"),y=h.find(".minicolors-grid"),b=h.find(".minicolors-slider"),w=h.find(".minicolors-opacity-slider"),E=y.find("[class$=-picker]"),S=b.find("[class$=-picker]"),x=w.find("[class$=-picker]");n=f(l(e.val(),true));if(!n)n=f(l(e.attr("data-default"),true));r=v(n);if(!t)e.val(n);if(m){i=e.attr("data-opacity")===""?1:c(parseFloat(e.attr("data-opacity")).toFixed(2),0,1);e.attr("data-opacity",i);p.find("SPAN").css("opacity",i);o=c(w.height()-w.height()*i,0,w.height());x.css("top",o+"px")}p.find("SPAN").css("backgroundColor",n);switch(g){case"wheel":u=c(Math.ceil(r.s*.75),0,y.height()/2);a=r.h*Math.PI/180;s=c(75-Math.cos(a)*u,0,y.width());o=c(75-Math.sin(a)*u,0,y.height());E.css({top:o+"px",left:s+"px"});o=150-r.b/(100/y.height());if(n==="")o=0;S.css("top",o+"px");b.css("backgroundColor",d({h:r.h,s:r.s,b:100}));break;case"saturation":s=c(5*r.h/12,0,150);o=c(y.height()-Math.ceil(r.b/(100/y.height())),0,y.height());E.css({top:o+"px",left:s+"px"});o=c(b.height()-r.s*(b.height()/100),0,b.height());S.css("top",o+"px");b.css("backgroundColor",d({h:r.h,s:100,b:r.b}));h.find(".minicolors-grid-inner").css("opacity",r.s/100);break;case"brightness":s=c(5*r.h/12,0,150);o=c(y.height()-Math.ceil(r.s/(100/y.height())),0,y.height());E.css({top:o+"px",left:s+"px"});o=c(b.height()-r.b*(b.height()/100),0,b.height());S.css("top",o+"px");b.css("backgroundColor",d({h:r.h,s:r.s,b:100}));h.find(".minicolors-grid-inner").css("opacity",1-r.b/100);break;default:s=c(Math.ceil(r.s/(100/y.width())),0,y.width());o=c(y.height()-Math.ceil(r.b/(100/y.height())),0,y.height());E.css({top:o+"px",left:s+"px"});o=c(b.height()-r.h/(360/b.height()),0,b.height());S.css("top",o+"px");y.css("backgroundColor",d({h:r.h,s:100,b:100}));break}}function f(t){return e.minicolors.settings.letterCase==="uppercase"?t.toUpperCase():t.toLowerCase()}function l(e,t){e=e.replace(/[^A-F0-9]/ig,"");if(e.length!==3&&e.length!==6)return"";if(e.length===3&&t){e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}return"#"+e}function c(e,t,n){if(e<t)e=t;if(e>n)e=n;return e}function h(e){var t={};var n=Math.round(e.h);var r=Math.round(e.s*255/100);var i=Math.round(e.b*255/100);if(r===0){t.r=t.g=t.b=i}else{var s=i;var o=(255-r)*i/255;var u=(s-o)*(n%60)/60;if(n===360)n=0;if(n<60){t.r=s;t.b=o;t.g=o+u}else if(n<120){t.g=s;t.b=o;t.r=s-u}else if(n<180){t.g=s;t.r=o;t.b=o+u}else if(n<240){t.b=s;t.r=o;t.g=s-u}else if(n<300){t.b=s;t.g=o;t.r=o+u}else if(n<360){t.r=s;t.g=o;t.b=s-u}else{t.r=0;t.g=0;t.b=0}}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}function p(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];e.each(n,function(e,t){if(t.length===1)n[e]="0"+t});return"#"+n.join("")}function d(e){return p(h(e))}function v(e){var t=m(g(e));if(t.s===0)t.h=360;return t}function m(e){var t={h:0,s:0,b:0};var n=Math.min(e.r,e.g,e.b);var r=Math.max(e.r,e.g,e.b);var i=r-n;t.b=r;t.s=r!==0?255*i/r:0;if(t.s!==0){if(e.r===r){t.h=(e.g-e.b)/i}else if(e.g===r){t.h=2+(e.b-e.r)/i}else{t.h=4+(e.r-e.g)/i}}else{t.h=-1}t.h*=60;if(t.h<0){t.h+=360}t.s*=100/255;t.b*=100/255;return t}function g(e){e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}}e.minicolors={settings:{defaultSlider:"hue",letterCase:"lowercase",hideSpeed:100,showSpeed:100,animationSpeed:100,animationEasing:"swing"},init:function(){e("INPUT[type=minicolors]").each(function(){t(e(this))})},remove:function(t){e(t).each(function(){r(e(this))})},refresh:function(){e("INPUT[type=minicolors]").each(function(){n(e(this))})},show:function(t){i(e(t).eq(0))},hide:function(){s()},rgbObject:function(t){var n=l(e(t).val(),true),r=g(n),i=t.attr("data-opacity");if(!r)return null;if(i!==undefined)e.extend(r,{a:parseFloat(i)});return r},rgbString:function(t){var n=l(e(t).val(),true),r=g(n),i=t.attr("data-opacity");if(!r)return null;if(i===undefined){return"rgb("+r.r+", "+r.g+", "+r.b+")"}else{return"rgba("+r.r+", "+r.g+", "+r.b+", "+parseFloat(i)+")"}}};e(window).on("load",function(){e.minicolors.init();e(document).on("mousedown touchstart",function(t){if(!e(t.target).parents().add(t.target).hasClass("minicolors")){s()}}).on("mousedown touchstart",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(t){var n=e(this);t.preventDefault();e(document).data("minicolors-target",n);o(n,t,true)}).on("mousemove touchmove",function(t){var n=e(document).data("minicolors-target");if(n)o(n,t)}).on("mouseup touchend",function(){e(this).removeData("minicolors-target")}).on("mousedown touchstart",".minicolors-swatch",function(t){var n=e(this).parent().find("INPUT"),r=n.parent();if(r.hasClass("minicolors-focus")){s(n)}else{i(n)}}).on("focus","INPUT[type=minicolors]",function(t){var n=e(this);if(!n.data("initialized"))return;i(n)}).on("blur","INPUT[type=minicolors]",function(t){var n=e(this);if(!n.data("initialized"))return;n.val(f(l(n.val()!==""?n.val():f(l(n.attr("data-default"),true)),true)));s(n)}).on("keydown","INPUT[type=minicolors]",function(t){var n=e(this);if(!n.data("initialized"))return;switch(t.keyCode){case 9:s();break;case 27:s();n.blur();break}}).on("keyup","INPUT[type=minicolors]",function(t){var n=e(this);if(!n.data("initialized"))return;a(n,true)}).on("paste","INPUT[type=minicolors]",function(t){var n=e(this);if(!n.data("initialized"))return;setTimeout(function(){a(n,true)},1)})})})(jQuery)